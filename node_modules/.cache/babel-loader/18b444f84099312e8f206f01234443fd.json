{"ast":null,"code":"import classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nvar classPrefix = \"adm-water-mark\";\nvar defaultProps = {\n  fullPage: true\n};\nexport var WaterMark = function WaterMark(p) {\n  var _classNames;\n\n  var props = mergeProps(defaultProps, p);\n  var _props$zIndex = props.zIndex,\n      zIndex = _props$zIndex === void 0 ? 2000 : _props$zIndex,\n      _props$gapX = props.gapX,\n      gapX = _props$gapX === void 0 ? 24 : _props$gapX,\n      _props$gapY = props.gapY,\n      gapY = _props$gapY === void 0 ? 48 : _props$gapY,\n      _props$width = props.width,\n      width = _props$width === void 0 ? 120 : _props$width,\n      _props$height = props.height,\n      height = _props$height === void 0 ? 64 : _props$height,\n      _props$rotate = props.rotate,\n      rotate = _props$rotate === void 0 ? -22 : _props$rotate,\n      image = props.image,\n      _props$imageWidth = props.imageWidth,\n      imageWidth = _props$imageWidth === void 0 ? 120 : _props$imageWidth,\n      _props$imageHeight = props.imageHeight,\n      imageHeight = _props$imageHeight === void 0 ? 64 : _props$imageHeight,\n      content = props.content,\n      _props$fontStyle = props.fontStyle,\n      fontStyle = _props$fontStyle === void 0 ? 'normal' : _props$fontStyle,\n      _props$fontWeight = props.fontWeight,\n      fontWeight = _props$fontWeight === void 0 ? 'normal' : _props$fontWeight,\n      _props$fontColor = props.fontColor,\n      fontColor = _props$fontColor === void 0 ? 'rgba(0,0,0,.15)' : _props$fontColor,\n      _props$fontSize = props.fontSize,\n      fontSize = _props$fontSize === void 0 ? 14 : _props$fontSize,\n      _props$fontFamily = props.fontFamily,\n      fontFamily = _props$fontFamily === void 0 ? 'sans-serif' : _props$fontFamily;\n\n  var _useState = useState(''),\n      base64Url = _useState[0],\n      setBase64Url = _useState[1];\n\n  useEffect(function () {\n    var canvas = document.createElement('canvas');\n    var ratio = window.devicePixelRatio;\n    var ctx = canvas.getContext('2d');\n    var canvasWidth = (gapX + width) * ratio + \"px\";\n    var canvasHeight = (gapY + height) * ratio + \"px\";\n    var markWidth = width * ratio;\n    var markHeight = height * ratio;\n    canvas.setAttribute('width', canvasWidth);\n    canvas.setAttribute('height', canvasHeight);\n\n    if (ctx) {\n      if (image) {\n        ctx.translate(markWidth / 2, markHeight / 2);\n        ctx.rotate(Math.PI / 180 * Number(rotate));\n        var img = new Image();\n        img.crossOrigin = 'anonymous';\n        img.referrerPolicy = 'no-referrer';\n        img.src = image;\n\n        img.onload = function () {\n          ctx.drawImage(img, -imageWidth * ratio / 2, -imageHeight * ratio / 2, imageWidth * ratio, imageHeight * ratio);\n          ctx.restore();\n          setBase64Url(canvas.toDataURL());\n        };\n      } else if (content) {\n        ctx.textBaseline = 'middle';\n        ctx.textAlign = 'center'; // 文字绕中间旋转\n\n        ctx.translate(markWidth / 2, markHeight / 2);\n        ctx.rotate(Math.PI / 180 * Number(rotate));\n        var markSize = Number(fontSize) * ratio;\n        ctx.font = fontStyle + \" normal \" + fontWeight + \" \" + markSize + \"px/\" + markHeight + \"px \" + fontFamily;\n        ctx.fillStyle = fontColor;\n        ctx.fillText(content, 0, 0);\n        ctx.restore();\n        setBase64Url(canvas.toDataURL());\n      }\n    } else {\n      throw new Error('当前环境不支持Canvas');\n    }\n  }, [gapX, gapY, rotate, fontStyle, fontWeight, width, height, fontFamily, fontColor, image, content, fontSize]);\n  return withNativeProps(props, /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(classPrefix, (_classNames = {}, _classNames[classPrefix + \"-full-page\"] = props.fullPage, _classNames)),\n    style: {\n      zIndex: zIndex,\n      backgroundSize: gapX + width + \"px\",\n      backgroundImage: \"url('\" + base64Url + \"')\"\n    }\n  }));\n};","map":{"version":3,"sources":["/Users/brandonliu/Project/goairmart/antd-demo/node_modules/antd-mobile/es/components/water-mark/water-mark.js"],"names":["classNames","React","useEffect","useState","withNativeProps","mergeProps","classPrefix","defaultProps","fullPage","WaterMark","p","_classNames","props","_props$zIndex","zIndex","_props$gapX","gapX","_props$gapY","gapY","_props$width","width","_props$height","height","_props$rotate","rotate","image","_props$imageWidth","imageWidth","_props$imageHeight","imageHeight","content","_props$fontStyle","fontStyle","_props$fontWeight","fontWeight","_props$fontColor","fontColor","_props$fontSize","fontSize","_props$fontFamily","fontFamily","_useState","base64Url","setBase64Url","canvas","document","createElement","ratio","window","devicePixelRatio","ctx","getContext","canvasWidth","canvasHeight","markWidth","markHeight","setAttribute","translate","Math","PI","Number","img","Image","crossOrigin","referrerPolicy","src","onload","drawImage","restore","toDataURL","textBaseline","textAlign","markSize","font","fillStyle","fillText","Error","className","style","backgroundSize","backgroundImage"],"mappings":"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","sourcesContent":["import classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nvar classPrefix = \"adm-water-mark\";\nvar defaultProps = {\n  fullPage: true\n};\nexport var WaterMark = function WaterMark(p) {\n  var _classNames;\n\n  var props = mergeProps(defaultProps, p);\n  var _props$zIndex = props.zIndex,\n      zIndex = _props$zIndex === void 0 ? 2000 : _props$zIndex,\n      _props$gapX = props.gapX,\n      gapX = _props$gapX === void 0 ? 24 : _props$gapX,\n      _props$gapY = props.gapY,\n      gapY = _props$gapY === void 0 ? 48 : _props$gapY,\n      _props$width = props.width,\n      width = _props$width === void 0 ? 120 : _props$width,\n      _props$height = props.height,\n      height = _props$height === void 0 ? 64 : _props$height,\n      _props$rotate = props.rotate,\n      rotate = _props$rotate === void 0 ? -22 : _props$rotate,\n      image = props.image,\n      _props$imageWidth = props.imageWidth,\n      imageWidth = _props$imageWidth === void 0 ? 120 : _props$imageWidth,\n      _props$imageHeight = props.imageHeight,\n      imageHeight = _props$imageHeight === void 0 ? 64 : _props$imageHeight,\n      content = props.content,\n      _props$fontStyle = props.fontStyle,\n      fontStyle = _props$fontStyle === void 0 ? 'normal' : _props$fontStyle,\n      _props$fontWeight = props.fontWeight,\n      fontWeight = _props$fontWeight === void 0 ? 'normal' : _props$fontWeight,\n      _props$fontColor = props.fontColor,\n      fontColor = _props$fontColor === void 0 ? 'rgba(0,0,0,.15)' : _props$fontColor,\n      _props$fontSize = props.fontSize,\n      fontSize = _props$fontSize === void 0 ? 14 : _props$fontSize,\n      _props$fontFamily = props.fontFamily,\n      fontFamily = _props$fontFamily === void 0 ? 'sans-serif' : _props$fontFamily;\n\n  var _useState = useState(''),\n      base64Url = _useState[0],\n      setBase64Url = _useState[1];\n\n  useEffect(function () {\n    var canvas = document.createElement('canvas');\n    var ratio = window.devicePixelRatio;\n    var ctx = canvas.getContext('2d');\n    var canvasWidth = (gapX + width) * ratio + \"px\";\n    var canvasHeight = (gapY + height) * ratio + \"px\";\n    var markWidth = width * ratio;\n    var markHeight = height * ratio;\n    canvas.setAttribute('width', canvasWidth);\n    canvas.setAttribute('height', canvasHeight);\n\n    if (ctx) {\n      if (image) {\n        ctx.translate(markWidth / 2, markHeight / 2);\n        ctx.rotate(Math.PI / 180 * Number(rotate));\n        var img = new Image();\n        img.crossOrigin = 'anonymous';\n        img.referrerPolicy = 'no-referrer';\n        img.src = image;\n\n        img.onload = function () {\n          ctx.drawImage(img, -imageWidth * ratio / 2, -imageHeight * ratio / 2, imageWidth * ratio, imageHeight * ratio);\n          ctx.restore();\n          setBase64Url(canvas.toDataURL());\n        };\n      } else if (content) {\n        ctx.textBaseline = 'middle';\n        ctx.textAlign = 'center'; // 文字绕中间旋转\n\n        ctx.translate(markWidth / 2, markHeight / 2);\n        ctx.rotate(Math.PI / 180 * Number(rotate));\n        var markSize = Number(fontSize) * ratio;\n        ctx.font = fontStyle + \" normal \" + fontWeight + \" \" + markSize + \"px/\" + markHeight + \"px \" + fontFamily;\n        ctx.fillStyle = fontColor;\n        ctx.fillText(content, 0, 0);\n        ctx.restore();\n        setBase64Url(canvas.toDataURL());\n      }\n    } else {\n      throw new Error('当前环境不支持Canvas');\n    }\n  }, [gapX, gapY, rotate, fontStyle, fontWeight, width, height, fontFamily, fontColor, image, content, fontSize]);\n  return withNativeProps(props, /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(classPrefix, (_classNames = {}, _classNames[classPrefix + \"-full-page\"] = props.fullPage, _classNames)),\n    style: {\n      zIndex: zIndex,\n      backgroundSize: gapX + width + \"px\",\n      backgroundImage: \"url('\" + base64Url + \"')\"\n    }\n  }));\n};"]},"metadata":{},"sourceType":"module"}