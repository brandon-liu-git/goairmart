{"ast":null,"code":"import React, { useLayoutEffect, useRef, useState } from 'react';\nimport { useSpring, animated } from '@react-spring/web';\nimport { useDrag } from '@use-gesture/react';\nimport { convertPx } from '../../utils/convert-px';\nimport { rubberbandIfOutOfBounds } from '../../utils/rubberband';\nimport { bound } from '../../utils/bound';\nimport { useDebounceFn } from 'ahooks';\nvar classPrefix = \"adm-picker-view\";\nexport var Column = function Column(props) {\n  var itemHeight = convertPx(34);\n  var value = props.value,\n      onSelect = props.onSelect,\n      column = props.column;\n\n  var _useSpring = useSpring(function () {\n    return {\n      from: {\n        y: 0\n      },\n      config: {\n        tension: 400,\n        mass: 0.8\n      }\n    };\n  }),\n      y = _useSpring[0].y,\n      api = _useSpring[1];\n\n  var draggingRef = useRef(false);\n\n  var _useState = useState({}),\n      flag = _useState[0],\n      setFlag = _useState[1];\n\n  useLayoutEffect(function () {\n    if (draggingRef.current) return;\n    if (!value) return;\n    var targetIndex = column.findIndex(function (item) {\n      return item.value === value;\n    });\n    if (targetIndex < 0) return;\n    var finalPosition = targetIndex * -itemHeight;\n    api.start({\n      y: finalPosition,\n      immediate: y.idle\n    });\n  }, [value, column, flag]);\n  useLayoutEffect(function () {\n    if (column.length === 0) {\n      if (value !== null) {\n        props.onSelect(null);\n      }\n    } else {\n      if (!column.some(function (item) {\n        return item.value === value;\n      })) {\n        var firstItem = column[0];\n        props.onSelect(firstItem.value);\n      }\n    }\n  }, [column, value]);\n\n  var _useDebounceFn = useDebounceFn(function () {\n    setFlag({});\n  }, {\n    wait: 1000,\n    leading: false,\n    trailing: true\n  }),\n      debouncedUpdateFlag = _useDebounceFn.run;\n\n  function scrollSelect(index) {\n    var finalPosition = index * -itemHeight;\n    api.start({\n      y: finalPosition\n    });\n    onSelect(column[index].value);\n    debouncedUpdateFlag();\n  }\n\n  var bind = useDrag(function (state) {\n    draggingRef.current = true;\n    var min = -((column.length - 1) * itemHeight);\n    var max = 0;\n\n    if (state.last) {\n      draggingRef.current = false;\n      var position = state.offset[1] + state.velocity[1] * state.direction[1] * 50;\n      var targetIndex = -Math.round(bound(position, min, max) / itemHeight);\n      scrollSelect(targetIndex);\n    } else {\n      var _position = state.offset[1];\n      api.start({\n        y: rubberbandIfOutOfBounds(_position, min, max, itemHeight * 50, 0.2)\n      });\n    }\n  }, {\n    axis: 'y',\n    from: function from() {\n      return [0, y.get()];\n    },\n    filterTaps: true,\n    pointer: {\n      touch: true\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"div\", Object.assign({\n    className: classPrefix + \"-column\"\n  }, bind()), /*#__PURE__*/React.createElement(animated.div, {\n    style: {\n      y: y\n    },\n    className: classPrefix + \"-column-wheel\"\n  }, column.map(function (item, index) {\n    function handleClick() {\n      draggingRef.current = false;\n      scrollSelect(index);\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item.value,\n      className: classPrefix + \"-column-item\",\n      onClick: handleClick\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: classPrefix + \"-column-item-label\"\n    }, item.label));\n  })));\n};","map":{"version":3,"sources":["/Users/brandonliu/Project/goairmart/antd-demo/node_modules/antd-mobile/es/components/picker-view/column.js"],"names":["React","useLayoutEffect","useRef","useState","useSpring","animated","useDrag","convertPx","rubberbandIfOutOfBounds","bound","useDebounceFn","classPrefix","Column","props","itemHeight","value","onSelect","column","_useSpring","from","y","config","tension","mass","api","draggingRef","_useState","flag","setFlag","current","targetIndex","findIndex","item","finalPosition","start","immediate","idle","length","some","firstItem","_useDebounceFn","wait","leading","trailing","debouncedUpdateFlag","run","scrollSelect","index","bind","state","min","max","last","position","offset","velocity","direction","Math","round","_position","axis","get","filterTaps","pointer","touch","createElement","Object","assign","className","div","style","map","handleClick","key","onClick","label"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,eAAhB,EAAiCC,MAAjC,EAAyCC,QAAzC,QAAyD,OAAzD;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,mBAApC;AACA,SAASC,OAAT,QAAwB,oBAAxB;AACA,SAASC,SAAT,QAA0B,wBAA1B;AACA,SAASC,uBAAT,QAAwC,wBAAxC;AACA,SAASC,KAAT,QAAsB,mBAAtB;AACA,SAASC,aAAT,QAA8B,QAA9B;AACA,IAAIC,WAAW,GAAG,iBAAlB;AACA,OAAO,IAAIC,MAAM,GAAG,SAASA,MAAT,CAAgBC,KAAhB,EAAuB;AACzC,MAAIC,UAAU,GAAGP,SAAS,CAAC,EAAD,CAA1B;AACA,MAAIQ,KAAK,GAAGF,KAAK,CAACE,KAAlB;AAAA,MACIC,QAAQ,GAAGH,KAAK,CAACG,QADrB;AAAA,MAEIC,MAAM,GAAGJ,KAAK,CAACI,MAFnB;;AAIA,MAAIC,UAAU,GAAGd,SAAS,CAAC,YAAY;AACrC,WAAO;AACLe,MAAAA,IAAI,EAAE;AACJC,QAAAA,CAAC,EAAE;AADC,OADD;AAILC,MAAAA,MAAM,EAAE;AACNC,QAAAA,OAAO,EAAE,GADH;AAENC,QAAAA,IAAI,EAAE;AAFA;AAJH,KAAP;AASD,GAVyB,CAA1B;AAAA,MAWIH,CAAC,GAAGF,UAAU,CAAC,CAAD,CAAV,CAAcE,CAXtB;AAAA,MAYII,GAAG,GAAGN,UAAU,CAAC,CAAD,CAZpB;;AAcA,MAAIO,WAAW,GAAGvB,MAAM,CAAC,KAAD,CAAxB;;AAEA,MAAIwB,SAAS,GAAGvB,QAAQ,CAAC,EAAD,CAAxB;AAAA,MACIwB,IAAI,GAAGD,SAAS,CAAC,CAAD,CADpB;AAAA,MAEIE,OAAO,GAAGF,SAAS,CAAC,CAAD,CAFvB;;AAIAzB,EAAAA,eAAe,CAAC,YAAY;AAC1B,QAAIwB,WAAW,CAACI,OAAhB,EAAyB;AACzB,QAAI,CAACd,KAAL,EAAY;AACZ,QAAIe,WAAW,GAAGb,MAAM,CAACc,SAAP,CAAiB,UAAUC,IAAV,EAAgB;AACjD,aAAOA,IAAI,CAACjB,KAAL,KAAeA,KAAtB;AACD,KAFiB,CAAlB;AAGA,QAAIe,WAAW,GAAG,CAAlB,EAAqB;AACrB,QAAIG,aAAa,GAAGH,WAAW,GAAG,CAAChB,UAAnC;AACAU,IAAAA,GAAG,CAACU,KAAJ,CAAU;AACRd,MAAAA,CAAC,EAAEa,aADK;AAERE,MAAAA,SAAS,EAAEf,CAAC,CAACgB;AAFL,KAAV;AAID,GAZc,EAYZ,CAACrB,KAAD,EAAQE,MAAR,EAAgBU,IAAhB,CAZY,CAAf;AAaA1B,EAAAA,eAAe,CAAC,YAAY;AAC1B,QAAIgB,MAAM,CAACoB,MAAP,KAAkB,CAAtB,EAAyB;AACvB,UAAItB,KAAK,KAAK,IAAd,EAAoB;AAClBF,QAAAA,KAAK,CAACG,QAAN,CAAe,IAAf;AACD;AACF,KAJD,MAIO;AACL,UAAI,CAACC,MAAM,CAACqB,IAAP,CAAY,UAAUN,IAAV,EAAgB;AAC/B,eAAOA,IAAI,CAACjB,KAAL,KAAeA,KAAtB;AACD,OAFI,CAAL,EAEI;AACF,YAAIwB,SAAS,GAAGtB,MAAM,CAAC,CAAD,CAAtB;AACAJ,QAAAA,KAAK,CAACG,QAAN,CAAeuB,SAAS,CAACxB,KAAzB;AACD;AACF;AACF,GAbc,EAaZ,CAACE,MAAD,EAASF,KAAT,CAbY,CAAf;;AAeA,MAAIyB,cAAc,GAAG9B,aAAa,CAAC,YAAY;AAC7CkB,IAAAA,OAAO,CAAC,EAAD,CAAP;AACD,GAFiC,EAE/B;AACDa,IAAAA,IAAI,EAAE,IADL;AAEDC,IAAAA,OAAO,EAAE,KAFR;AAGDC,IAAAA,QAAQ,EAAE;AAHT,GAF+B,CAAlC;AAAA,MAOIC,mBAAmB,GAAGJ,cAAc,CAACK,GAPzC;;AASA,WAASC,YAAT,CAAsBC,KAAtB,EAA6B;AAC3B,QAAId,aAAa,GAAGc,KAAK,GAAG,CAACjC,UAA7B;AACAU,IAAAA,GAAG,CAACU,KAAJ,CAAU;AACRd,MAAAA,CAAC,EAAEa;AADK,KAAV;AAGAjB,IAAAA,QAAQ,CAACC,MAAM,CAAC8B,KAAD,CAAN,CAAchC,KAAf,CAAR;AACA6B,IAAAA,mBAAmB;AACpB;;AAED,MAAII,IAAI,GAAG1C,OAAO,CAAC,UAAU2C,KAAV,EAAiB;AAClCxB,IAAAA,WAAW,CAACI,OAAZ,GAAsB,IAAtB;AACA,QAAIqB,GAAG,GAAG,EAAE,CAACjC,MAAM,CAACoB,MAAP,GAAgB,CAAjB,IAAsBvB,UAAxB,CAAV;AACA,QAAIqC,GAAG,GAAG,CAAV;;AAEA,QAAIF,KAAK,CAACG,IAAV,EAAgB;AACd3B,MAAAA,WAAW,CAACI,OAAZ,GAAsB,KAAtB;AACA,UAAIwB,QAAQ,GAAGJ,KAAK,CAACK,MAAN,CAAa,CAAb,IAAkBL,KAAK,CAACM,QAAN,CAAe,CAAf,IAAoBN,KAAK,CAACO,SAAN,CAAgB,CAAhB,CAApB,GAAyC,EAA1E;AACA,UAAI1B,WAAW,GAAG,CAAC2B,IAAI,CAACC,KAAL,CAAWjD,KAAK,CAAC4C,QAAD,EAAWH,GAAX,EAAgBC,GAAhB,CAAL,GAA4BrC,UAAvC,CAAnB;AACAgC,MAAAA,YAAY,CAAChB,WAAD,CAAZ;AACD,KALD,MAKO;AACL,UAAI6B,SAAS,GAAGV,KAAK,CAACK,MAAN,CAAa,CAAb,CAAhB;AACA9B,MAAAA,GAAG,CAACU,KAAJ,CAAU;AACRd,QAAAA,CAAC,EAAEZ,uBAAuB,CAACmD,SAAD,EAAYT,GAAZ,EAAiBC,GAAjB,EAAsBrC,UAAU,GAAG,EAAnC,EAAuC,GAAvC;AADlB,OAAV;AAGD;AACF,GAhBiB,EAgBf;AACD8C,IAAAA,IAAI,EAAE,GADL;AAEDzC,IAAAA,IAAI,EAAE,SAASA,IAAT,GAAgB;AACpB,aAAO,CAAC,CAAD,EAAIC,CAAC,CAACyC,GAAF,EAAJ,CAAP;AACD,KAJA;AAKDC,IAAAA,UAAU,EAAE,IALX;AAMDC,IAAAA,OAAO,EAAE;AACPC,MAAAA,KAAK,EAAE;AADA;AANR,GAhBe,CAAlB;AA0BA,SAAO,aAAahE,KAAK,CAACiE,aAAN,CAAoB,KAApB,EAA2BC,MAAM,CAACC,MAAP,CAAc;AAC3DC,IAAAA,SAAS,EAAEzD,WAAW,GAAG;AADkC,GAAd,EAE5CqC,IAAI,EAFwC,CAA3B,EAER,aAAahD,KAAK,CAACiE,aAAN,CAAoB5D,QAAQ,CAACgE,GAA7B,EAAkC;AACzDC,IAAAA,KAAK,EAAE;AACLlD,MAAAA,CAAC,EAAEA;AADE,KADkD;AAIzDgD,IAAAA,SAAS,EAAEzD,WAAW,GAAG;AAJgC,GAAlC,EAKtBM,MAAM,CAACsD,GAAP,CAAW,UAAUvC,IAAV,EAAgBe,KAAhB,EAAuB;AACnC,aAASyB,WAAT,GAAuB;AACrB/C,MAAAA,WAAW,CAACI,OAAZ,GAAsB,KAAtB;AACAiB,MAAAA,YAAY,CAACC,KAAD,CAAZ;AACD;;AAED,WAAO,aAAa/C,KAAK,CAACiE,aAAN,CAAoB,KAApB,EAA2B;AAC7CQ,MAAAA,GAAG,EAAEzC,IAAI,CAACjB,KADmC;AAE7CqD,MAAAA,SAAS,EAAEzD,WAAW,GAAG,cAFoB;AAG7C+D,MAAAA,OAAO,EAAEF;AAHoC,KAA3B,EAIjB,aAAaxE,KAAK,CAACiE,aAAN,CAAoB,KAApB,EAA2B;AACzCG,MAAAA,SAAS,EAAEzD,WAAW,GAAG;AADgB,KAA3B,EAEbqB,IAAI,CAAC2C,KAFQ,CAJI,CAApB;AAOD,GAbE,CALsB,CAFL,CAApB;AAqBD,CAvHM","sourcesContent":["import React, { useLayoutEffect, useRef, useState } from 'react';\nimport { useSpring, animated } from '@react-spring/web';\nimport { useDrag } from '@use-gesture/react';\nimport { convertPx } from '../../utils/convert-px';\nimport { rubberbandIfOutOfBounds } from '../../utils/rubberband';\nimport { bound } from '../../utils/bound';\nimport { useDebounceFn } from 'ahooks';\nvar classPrefix = \"adm-picker-view\";\nexport var Column = function Column(props) {\n  var itemHeight = convertPx(34);\n  var value = props.value,\n      onSelect = props.onSelect,\n      column = props.column;\n\n  var _useSpring = useSpring(function () {\n    return {\n      from: {\n        y: 0\n      },\n      config: {\n        tension: 400,\n        mass: 0.8\n      }\n    };\n  }),\n      y = _useSpring[0].y,\n      api = _useSpring[1];\n\n  var draggingRef = useRef(false);\n\n  var _useState = useState({}),\n      flag = _useState[0],\n      setFlag = _useState[1];\n\n  useLayoutEffect(function () {\n    if (draggingRef.current) return;\n    if (!value) return;\n    var targetIndex = column.findIndex(function (item) {\n      return item.value === value;\n    });\n    if (targetIndex < 0) return;\n    var finalPosition = targetIndex * -itemHeight;\n    api.start({\n      y: finalPosition,\n      immediate: y.idle\n    });\n  }, [value, column, flag]);\n  useLayoutEffect(function () {\n    if (column.length === 0) {\n      if (value !== null) {\n        props.onSelect(null);\n      }\n    } else {\n      if (!column.some(function (item) {\n        return item.value === value;\n      })) {\n        var firstItem = column[0];\n        props.onSelect(firstItem.value);\n      }\n    }\n  }, [column, value]);\n\n  var _useDebounceFn = useDebounceFn(function () {\n    setFlag({});\n  }, {\n    wait: 1000,\n    leading: false,\n    trailing: true\n  }),\n      debouncedUpdateFlag = _useDebounceFn.run;\n\n  function scrollSelect(index) {\n    var finalPosition = index * -itemHeight;\n    api.start({\n      y: finalPosition\n    });\n    onSelect(column[index].value);\n    debouncedUpdateFlag();\n  }\n\n  var bind = useDrag(function (state) {\n    draggingRef.current = true;\n    var min = -((column.length - 1) * itemHeight);\n    var max = 0;\n\n    if (state.last) {\n      draggingRef.current = false;\n      var position = state.offset[1] + state.velocity[1] * state.direction[1] * 50;\n      var targetIndex = -Math.round(bound(position, min, max) / itemHeight);\n      scrollSelect(targetIndex);\n    } else {\n      var _position = state.offset[1];\n      api.start({\n        y: rubberbandIfOutOfBounds(_position, min, max, itemHeight * 50, 0.2)\n      });\n    }\n  }, {\n    axis: 'y',\n    from: function from() {\n      return [0, y.get()];\n    },\n    filterTaps: true,\n    pointer: {\n      touch: true\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"div\", Object.assign({\n    className: classPrefix + \"-column\"\n  }, bind()), /*#__PURE__*/React.createElement(animated.div, {\n    style: {\n      y: y\n    },\n    className: classPrefix + \"-column-wheel\"\n  }, column.map(function (item, index) {\n    function handleClick() {\n      draggingRef.current = false;\n      scrollSelect(index);\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item.value,\n      className: classPrefix + \"-column-item\",\n      onClick: handleClick\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: classPrefix + \"-column-item-label\"\n    }, item.label));\n  })));\n};"]},"metadata":{},"sourceType":"module"}