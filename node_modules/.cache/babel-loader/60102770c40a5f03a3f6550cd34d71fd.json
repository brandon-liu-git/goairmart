{"ast":null,"code":"import React, { forwardRef, useImperativeHandle, useRef, useState } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useDrag } from '@use-gesture/react';\nimport { useSpring, animated } from '@react-spring/web';\nimport { supportsPassive } from '../../utils/supports-passive';\nimport { nearest } from '../../utils/nearest';\nexport var FloatingPanel = /*#__PURE__*/forwardRef(function (props, ref) {\n  var _a;\n\n  var anchors = props.anchors;\n  var maxHeight = (_a = anchors[anchors.length - 1]) !== null && _a !== void 0 ? _a : window.innerHeight;\n  var possibles = anchors.map(function (x) {\n    return -x;\n  });\n  var elementRef = useRef(null);\n  var headerRef = useRef(null);\n  var contentRef = useRef(null);\n\n  var _useState = useState(false),\n      pulling = _useState[0],\n      setPulling = _useState[1];\n\n  var pullingRef = useRef(false);\n  var bounds = {\n    top: possibles[possibles.length - 1],\n    bottom: possibles[0]\n  };\n\n  var _useSpring = useSpring(function () {\n    return {\n      y: bounds.bottom,\n      config: {\n        tension: 300\n      }\n    };\n  }),\n      y = _useSpring[0].y,\n      api = _useSpring[1];\n\n  useDrag(function (state) {\n    var _state$offset = state.offset,\n        offsetY = _state$offset[1];\n\n    if (state.first) {\n      var target = state.event.target;\n      var header = headerRef.current;\n\n      if (header === target || (header === null || header === void 0 ? void 0 : header.contains(target))) {\n        pullingRef.current = true;\n      } else {\n        var reachedTop = y.goal <= bounds.top;\n        var content = contentRef.current;\n        if (!content) return;\n\n        if (reachedTop) {\n          if (content.scrollTop <= 0 && state.direction[1] > 0) {\n            pullingRef.current = true;\n          }\n        } else {\n          pullingRef.current = true;\n        }\n      }\n    }\n\n    setPulling(pullingRef.current);\n    if (!pullingRef.current) return;\n    var event = state.event;\n\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n\n    event.stopPropagation();\n    var nextY = offsetY;\n\n    if (state.last) {\n      pullingRef.current = false;\n      setPulling(false);\n      nextY = nearest(possibles, offsetY);\n    }\n\n    api.start({\n      y: nextY\n    });\n  }, {\n    axis: 'y',\n    bounds: bounds,\n    rubberband: true,\n    from: function from() {\n      return [0, y.get()];\n    },\n    pointer: {\n      touch: true\n    },\n    target: elementRef,\n    eventOptions: supportsPassive ? {\n      passive: false\n    } : false\n  });\n  useImperativeHandle(ref, function () {\n    return {\n      setHeight: function setHeight(height, options) {\n        api.start({\n          y: -height,\n          immediate: options === null || options === void 0 ? void 0 : options.immediate\n        });\n      }\n    };\n  }, [api]);\n  return withNativeProps(props, /*#__PURE__*/React.createElement(animated.div, {\n    ref: elementRef,\n    className: 'adm-floating-panel',\n    style: {\n      height: maxHeight,\n      y: y\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: 'adm-floating-panel-mask',\n    style: {\n      display: pulling ? 'block' : 'none'\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: 'adm-floating-panel-header',\n    ref: headerRef\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: 'adm-floating-panel-bar'\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: 'adm-floating-panel-content',\n    ref: contentRef\n  }, props.children)));\n});","map":{"version":3,"sources":["/Users/brandonliu/Project/goairmart/antd-demo/node_modules/antd-mobile/es/components/floating-panel/floating-panel.js"],"names":["React","forwardRef","useImperativeHandle","useRef","useState","withNativeProps","useDrag","useSpring","animated","supportsPassive","nearest","FloatingPanel","props","ref","_a","anchors","maxHeight","length","window","innerHeight","possibles","map","x","elementRef","headerRef","contentRef","_useState","pulling","setPulling","pullingRef","bounds","top","bottom","_useSpring","y","config","tension","api","state","_state$offset","offset","offsetY","first","target","event","header","current","contains","reachedTop","goal","content","scrollTop","direction","cancelable","preventDefault","stopPropagation","nextY","last","start","axis","rubberband","from","get","pointer","touch","eventOptions","passive","setHeight","height","options","immediate","createElement","div","className","style","display","children"],"mappings":"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","sourcesContent":["import React, { forwardRef, useImperativeHandle, useRef, useState } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useDrag } from '@use-gesture/react';\nimport { useSpring, animated } from '@react-spring/web';\nimport { supportsPassive } from '../../utils/supports-passive';\nimport { nearest } from '../../utils/nearest';\nexport var FloatingPanel = /*#__PURE__*/forwardRef(function (props, ref) {\n  var _a;\n\n  var anchors = props.anchors;\n  var maxHeight = (_a = anchors[anchors.length - 1]) !== null && _a !== void 0 ? _a : window.innerHeight;\n  var possibles = anchors.map(function (x) {\n    return -x;\n  });\n  var elementRef = useRef(null);\n  var headerRef = useRef(null);\n  var contentRef = useRef(null);\n\n  var _useState = useState(false),\n      pulling = _useState[0],\n      setPulling = _useState[1];\n\n  var pullingRef = useRef(false);\n  var bounds = {\n    top: possibles[possibles.length - 1],\n    bottom: possibles[0]\n  };\n\n  var _useSpring = useSpring(function () {\n    return {\n      y: bounds.bottom,\n      config: {\n        tension: 300\n      }\n    };\n  }),\n      y = _useSpring[0].y,\n      api = _useSpring[1];\n\n  useDrag(function (state) {\n    var _state$offset = state.offset,\n        offsetY = _state$offset[1];\n\n    if (state.first) {\n      var target = state.event.target;\n      var header = headerRef.current;\n\n      if (header === target || (header === null || header === void 0 ? void 0 : header.contains(target))) {\n        pullingRef.current = true;\n      } else {\n        var reachedTop = y.goal <= bounds.top;\n        var content = contentRef.current;\n        if (!content) return;\n\n        if (reachedTop) {\n          if (content.scrollTop <= 0 && state.direction[1] > 0) {\n            pullingRef.current = true;\n          }\n        } else {\n          pullingRef.current = true;\n        }\n      }\n    }\n\n    setPulling(pullingRef.current);\n    if (!pullingRef.current) return;\n    var event = state.event;\n\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n\n    event.stopPropagation();\n    var nextY = offsetY;\n\n    if (state.last) {\n      pullingRef.current = false;\n      setPulling(false);\n      nextY = nearest(possibles, offsetY);\n    }\n\n    api.start({\n      y: nextY\n    });\n  }, {\n    axis: 'y',\n    bounds: bounds,\n    rubberband: true,\n    from: function from() {\n      return [0, y.get()];\n    },\n    pointer: {\n      touch: true\n    },\n    target: elementRef,\n    eventOptions: supportsPassive ? {\n      passive: false\n    } : false\n  });\n  useImperativeHandle(ref, function () {\n    return {\n      setHeight: function setHeight(height, options) {\n        api.start({\n          y: -height,\n          immediate: options === null || options === void 0 ? void 0 : options.immediate\n        });\n      }\n    };\n  }, [api]);\n  return withNativeProps(props, /*#__PURE__*/React.createElement(animated.div, {\n    ref: elementRef,\n    className: 'adm-floating-panel',\n    style: {\n      height: maxHeight,\n      y: y\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: 'adm-floating-panel-mask',\n    style: {\n      display: pulling ? 'block' : 'none'\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: 'adm-floating-panel-header',\n    ref: headerRef\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: 'adm-floating-panel-bar'\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: 'adm-floating-panel-content',\n    ref: contentRef\n  }, props.children)));\n});"]},"metadata":{},"sourceType":"module"}