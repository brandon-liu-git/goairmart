{"ast":null,"code":"import React, { useMemo, useRef } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport classNames from 'classnames';\nimport Ticks from './ticks';\nimport Marks from './marks';\nimport Thumb from './thumb';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { nearest } from '../../utils/nearest';\nimport { usePropsValue } from '../../utils/use-props-value';\nvar classPrefix = \"adm-slider\";\nvar defaultProps = {\n  min: 0,\n  max: 100,\n  step: 1,\n  ticks: false,\n  range: false,\n  disabled: false\n};\nexport var Slider = function Slider(p) {\n  var _classNames;\n\n  var _a;\n\n  var props = mergeProps(defaultProps, p);\n  var min = props.min,\n      max = props.max,\n      disabled = props.disabled,\n      marks = props.marks,\n      ticks = props.ticks,\n      step = props.step;\n\n  function sortValue(val) {\n    return val.sort(function (a, b) {\n      return a - b;\n    });\n  }\n\n  function convertValue(value) {\n    return props.range ? value : [props.min, value];\n  }\n\n  function reverseValue(value) {\n    return props.range ? value : value[1];\n  }\n\n  function onAfterChange(value) {\n    var _a;\n\n    (_a = props.onAfterChange) === null || _a === void 0 ? void 0 : _a.call(props, reverseValue(value));\n  }\n\n  var _usePropsValue = usePropsValue({\n    value: props.value,\n    defaultValue: (_a = props.defaultValue) !== null && _a !== void 0 ? _a : props.range ? [min, min] : min,\n    onChange: props.onChange\n  }),\n      rawValue = _usePropsValue[0],\n      setRawValue = _usePropsValue[1];\n\n  var sliderValue = sortValue(convertValue(rawValue));\n\n  function setSliderValue(value) {\n    var next = sortValue(value);\n    var current = sliderValue;\n    if (next[0] === current[0] && next[1] === current[1]) return;\n    setRawValue(reverseValue(next));\n  }\n\n  var trackRef = useRef(null);\n  var fillSize = 100 * (sliderValue[1] - sliderValue[0]) / (max - min) + \"%\";\n  var fillStart = 100 * (sliderValue[0] - min) / (max - min) + \"%\"; // 计算要显示的点\n\n  var pointList = useMemo(function () {\n    if (marks) {\n      return Object.keys(marks).map(parseFloat).sort(function (a, b) {\n        return a - b;\n      });\n    } else {\n      var points = [];\n\n      for (var i = min; i <= max; i += step) {\n        points.push(i);\n      }\n\n      return points;\n    }\n  }, [marks, ticks, step, min, max]);\n\n  function getValueByPosition(position) {\n    var newPosition = position < min ? min : position > max ? max : position;\n    var value = min; // 显示了刻度点，就只能移动到点上\n\n    if (pointList.length) {\n      value = nearest(pointList, newPosition);\n    } else {\n      var lengthPerStep = 100 / ((max - min) / step);\n      var steps = Math.round(newPosition / lengthPerStep);\n      value = steps * lengthPerStep * (max - min) * 0.01 + min;\n    }\n\n    return value;\n  }\n\n  var dragLockRef = useRef(0);\n\n  var onTrackClick = function onTrackClick(event) {\n    if (dragLockRef.current > 0) return;\n    event.stopPropagation();\n    if (disabled) return;\n    var track = trackRef.current;\n    if (!track) return;\n    var sliderOffsetLeft = track.getBoundingClientRect().left;\n    var position = (event.clientX - sliderOffsetLeft) / Math.ceil(track.offsetWidth) * (max - min) + min;\n    var targetValue = getValueByPosition(position);\n    var nextSliderValue;\n\n    if (props.range) {\n      // 移动的滑块采用就近原则\n      if (Math.abs(targetValue - sliderValue[0]) > Math.abs(targetValue - sliderValue[1])) {\n        nextSliderValue = [sliderValue[0], targetValue];\n      } else {\n        nextSliderValue = [targetValue, sliderValue[1]];\n      }\n    } else {\n      nextSliderValue = [props.min, targetValue];\n    }\n\n    setSliderValue(nextSliderValue);\n    onAfterChange(nextSliderValue);\n  };\n\n  var valueBeforeDragRef = useRef();\n\n  var renderThumb = function renderThumb(index) {\n    return /*#__PURE__*/React.createElement(Thumb, {\n      key: index,\n      value: sliderValue[index],\n      min: min,\n      max: max,\n      disabled: disabled,\n      trackRef: trackRef,\n      onDrag: function onDrag(position, first, last) {\n        if (first) {\n          dragLockRef.current += 1;\n          valueBeforeDragRef.current = sliderValue;\n        }\n\n        var val = getValueByPosition(position);\n        var valueBeforeDrag = valueBeforeDragRef.current;\n        if (!valueBeforeDrag) return;\n        var next = [].concat(valueBeforeDrag);\n        next[index] = val;\n        setSliderValue(next);\n\n        if (last) {\n          onAfterChange(next);\n          window.setTimeout(function () {\n            dragLockRef.current -= 1;\n          }, 100);\n        }\n      }\n    });\n  };\n\n  return withNativeProps(props, /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(classPrefix, (_classNames = {}, _classNames[classPrefix + \"-disabled\"] = disabled, _classNames))\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classPrefix + \"-track-container\",\n    onClick: onTrackClick\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classPrefix + \"-track\",\n    onClick: onTrackClick,\n    ref: trackRef\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classPrefix + \"-fill\",\n    style: {\n      width: fillSize,\n      left: fillStart\n    }\n  }), props.ticks && /*#__PURE__*/React.createElement(Ticks, {\n    points: pointList,\n    min: min,\n    max: max,\n    lowerBound: sliderValue[0],\n    upperBound: sliderValue[1]\n  }), props.range && renderThumb(0), renderThumb(1))), marks && /*#__PURE__*/React.createElement(Marks, {\n    min: min,\n    max: max,\n    marks: marks,\n    lowerBound: sliderValue[0],\n    upperBound: sliderValue[1]\n  })));\n};","map":{"version":3,"sources":["/Users/brandonliu/Project/goairmart/antd-demo/node_modules/antd-mobile/es/components/slider/slider.js"],"names":["React","useMemo","useRef","withNativeProps","classNames","Ticks","Marks","Thumb","mergeProps","nearest","usePropsValue","classPrefix","defaultProps","min","max","step","ticks","range","disabled","Slider","p","_classNames","_a","props","marks","sortValue","val","sort","a","b","convertValue","value","reverseValue","onAfterChange","call","_usePropsValue","defaultValue","onChange","rawValue","setRawValue","sliderValue","setSliderValue","next","current","trackRef","fillSize","fillStart","pointList","Object","keys","map","parseFloat","points","i","push","getValueByPosition","position","newPosition","length","lengthPerStep","steps","Math","round","dragLockRef","onTrackClick","event","stopPropagation","track","sliderOffsetLeft","getBoundingClientRect","left","clientX","ceil","offsetWidth","targetValue","nextSliderValue","abs","valueBeforeDragRef","renderThumb","index","createElement","key","onDrag","first","last","valueBeforeDrag","concat","window","setTimeout","className","onClick","ref","style","width","lowerBound","upperBound"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,OAAhB,EAAyBC,MAAzB,QAAuC,OAAvC;AACA,SAASC,eAAT,QAAgC,0BAAhC;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,UAAT,QAA2B,gCAA3B;AACA,SAASC,OAAT,QAAwB,qBAAxB;AACA,SAASC,aAAT,QAA8B,6BAA9B;AACA,IAAIC,WAAW,GAAG,YAAlB;AACA,IAAIC,YAAY,GAAG;AACjBC,EAAAA,GAAG,EAAE,CADY;AAEjBC,EAAAA,GAAG,EAAE,GAFY;AAGjBC,EAAAA,IAAI,EAAE,CAHW;AAIjBC,EAAAA,KAAK,EAAE,KAJU;AAKjBC,EAAAA,KAAK,EAAE,KALU;AAMjBC,EAAAA,QAAQ,EAAE;AANO,CAAnB;AAQA,OAAO,IAAIC,MAAM,GAAG,SAASA,MAAT,CAAgBC,CAAhB,EAAmB;AACrC,MAAIC,WAAJ;;AAEA,MAAIC,EAAJ;;AAEA,MAAIC,KAAK,GAAGf,UAAU,CAACI,YAAD,EAAeQ,CAAf,CAAtB;AACA,MAAIP,GAAG,GAAGU,KAAK,CAACV,GAAhB;AAAA,MACIC,GAAG,GAAGS,KAAK,CAACT,GADhB;AAAA,MAEII,QAAQ,GAAGK,KAAK,CAACL,QAFrB;AAAA,MAGIM,KAAK,GAAGD,KAAK,CAACC,KAHlB;AAAA,MAIIR,KAAK,GAAGO,KAAK,CAACP,KAJlB;AAAA,MAKID,IAAI,GAAGQ,KAAK,CAACR,IALjB;;AAOA,WAASU,SAAT,CAAmBC,GAAnB,EAAwB;AACtB,WAAOA,GAAG,CAACC,IAAJ,CAAS,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC9B,aAAOD,CAAC,GAAGC,CAAX;AACD,KAFM,CAAP;AAGD;;AAED,WAASC,YAAT,CAAsBC,KAAtB,EAA6B;AAC3B,WAAOR,KAAK,CAACN,KAAN,GAAcc,KAAd,GAAsB,CAACR,KAAK,CAACV,GAAP,EAAYkB,KAAZ,CAA7B;AACD;;AAED,WAASC,YAAT,CAAsBD,KAAtB,EAA6B;AAC3B,WAAOR,KAAK,CAACN,KAAN,GAAcc,KAAd,GAAsBA,KAAK,CAAC,CAAD,CAAlC;AACD;;AAED,WAASE,aAAT,CAAuBF,KAAvB,EAA8B;AAC5B,QAAIT,EAAJ;;AAEA,KAACA,EAAE,GAAGC,KAAK,CAACU,aAAZ,MAA+B,IAA/B,IAAuCX,EAAE,KAAK,KAAK,CAAnD,GAAuD,KAAK,CAA5D,GAAgEA,EAAE,CAACY,IAAH,CAAQX,KAAR,EAAeS,YAAY,CAACD,KAAD,CAA3B,CAAhE;AACD;;AAED,MAAII,cAAc,GAAGzB,aAAa,CAAC;AACjCqB,IAAAA,KAAK,EAAER,KAAK,CAACQ,KADoB;AAEjCK,IAAAA,YAAY,EAAE,CAACd,EAAE,GAAGC,KAAK,CAACa,YAAZ,MAA8B,IAA9B,IAAsCd,EAAE,KAAK,KAAK,CAAlD,GAAsDA,EAAtD,GAA2DC,KAAK,CAACN,KAAN,GAAc,CAACJ,GAAD,EAAMA,GAAN,CAAd,GAA2BA,GAFnE;AAGjCwB,IAAAA,QAAQ,EAAEd,KAAK,CAACc;AAHiB,GAAD,CAAlC;AAAA,MAKIC,QAAQ,GAAGH,cAAc,CAAC,CAAD,CAL7B;AAAA,MAMII,WAAW,GAAGJ,cAAc,CAAC,CAAD,CANhC;;AAQA,MAAIK,WAAW,GAAGf,SAAS,CAACK,YAAY,CAACQ,QAAD,CAAb,CAA3B;;AAEA,WAASG,cAAT,CAAwBV,KAAxB,EAA+B;AAC7B,QAAIW,IAAI,GAAGjB,SAAS,CAACM,KAAD,CAApB;AACA,QAAIY,OAAO,GAAGH,WAAd;AACA,QAAIE,IAAI,CAAC,CAAD,CAAJ,KAAYC,OAAO,CAAC,CAAD,CAAnB,IAA0BD,IAAI,CAAC,CAAD,CAAJ,KAAYC,OAAO,CAAC,CAAD,CAAjD,EAAsD;AACtDJ,IAAAA,WAAW,CAACP,YAAY,CAACU,IAAD,CAAb,CAAX;AACD;;AAED,MAAIE,QAAQ,GAAG1C,MAAM,CAAC,IAAD,CAArB;AACA,MAAI2C,QAAQ,GAAG,OAAOL,WAAW,CAAC,CAAD,CAAX,GAAiBA,WAAW,CAAC,CAAD,CAAnC,KAA2C1B,GAAG,GAAGD,GAAjD,IAAwD,GAAvE;AACA,MAAIiC,SAAS,GAAG,OAAON,WAAW,CAAC,CAAD,CAAX,GAAiB3B,GAAxB,KAAgCC,GAAG,GAAGD,GAAtC,IAA6C,GAA7D,CApDqC,CAoD6B;;AAElE,MAAIkC,SAAS,GAAG9C,OAAO,CAAC,YAAY;AAClC,QAAIuB,KAAJ,EAAW;AACT,aAAOwB,MAAM,CAACC,IAAP,CAAYzB,KAAZ,EAAmB0B,GAAnB,CAAuBC,UAAvB,EAAmCxB,IAAnC,CAAwC,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC7D,eAAOD,CAAC,GAAGC,CAAX;AACD,OAFM,CAAP;AAGD,KAJD,MAIO;AACL,UAAIuB,MAAM,GAAG,EAAb;;AAEA,WAAK,IAAIC,CAAC,GAAGxC,GAAb,EAAkBwC,CAAC,IAAIvC,GAAvB,EAA4BuC,CAAC,IAAItC,IAAjC,EAAuC;AACrCqC,QAAAA,MAAM,CAACE,IAAP,CAAYD,CAAZ;AACD;;AAED,aAAOD,MAAP;AACD;AACF,GAdsB,EAcpB,CAAC5B,KAAD,EAAQR,KAAR,EAAeD,IAAf,EAAqBF,GAArB,EAA0BC,GAA1B,CAdoB,CAAvB;;AAgBA,WAASyC,kBAAT,CAA4BC,QAA5B,EAAsC;AACpC,QAAIC,WAAW,GAAGD,QAAQ,GAAG3C,GAAX,GAAiBA,GAAjB,GAAuB2C,QAAQ,GAAG1C,GAAX,GAAiBA,GAAjB,GAAuB0C,QAAhE;AACA,QAAIzB,KAAK,GAAGlB,GAAZ,CAFoC,CAEnB;;AAEjB,QAAIkC,SAAS,CAACW,MAAd,EAAsB;AACpB3B,MAAAA,KAAK,GAAGtB,OAAO,CAACsC,SAAD,EAAYU,WAAZ,CAAf;AACD,KAFD,MAEO;AACL,UAAIE,aAAa,GAAG,OAAO,CAAC7C,GAAG,GAAGD,GAAP,IAAcE,IAArB,CAApB;AACA,UAAI6C,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWL,WAAW,GAAGE,aAAzB,CAAZ;AACA5B,MAAAA,KAAK,GAAG6B,KAAK,GAAGD,aAAR,IAAyB7C,GAAG,GAAGD,GAA/B,IAAsC,IAAtC,GAA6CA,GAArD;AACD;;AAED,WAAOkB,KAAP;AACD;;AAED,MAAIgC,WAAW,GAAG7D,MAAM,CAAC,CAAD,CAAxB;;AAEA,MAAI8D,YAAY,GAAG,SAASA,YAAT,CAAsBC,KAAtB,EAA6B;AAC9C,QAAIF,WAAW,CAACpB,OAAZ,GAAsB,CAA1B,EAA6B;AAC7BsB,IAAAA,KAAK,CAACC,eAAN;AACA,QAAIhD,QAAJ,EAAc;AACd,QAAIiD,KAAK,GAAGvB,QAAQ,CAACD,OAArB;AACA,QAAI,CAACwB,KAAL,EAAY;AACZ,QAAIC,gBAAgB,GAAGD,KAAK,CAACE,qBAAN,GAA8BC,IAArD;AACA,QAAId,QAAQ,GAAG,CAACS,KAAK,CAACM,OAAN,GAAgBH,gBAAjB,IAAqCP,IAAI,CAACW,IAAL,CAAUL,KAAK,CAACM,WAAhB,CAArC,IAAqE3D,GAAG,GAAGD,GAA3E,IAAkFA,GAAjG;AACA,QAAI6D,WAAW,GAAGnB,kBAAkB,CAACC,QAAD,CAApC;AACA,QAAImB,eAAJ;;AAEA,QAAIpD,KAAK,CAACN,KAAV,EAAiB;AACf;AACA,UAAI4C,IAAI,CAACe,GAAL,CAASF,WAAW,GAAGlC,WAAW,CAAC,CAAD,CAAlC,IAAyCqB,IAAI,CAACe,GAAL,CAASF,WAAW,GAAGlC,WAAW,CAAC,CAAD,CAAlC,CAA7C,EAAqF;AACnFmC,QAAAA,eAAe,GAAG,CAACnC,WAAW,CAAC,CAAD,CAAZ,EAAiBkC,WAAjB,CAAlB;AACD,OAFD,MAEO;AACLC,QAAAA,eAAe,GAAG,CAACD,WAAD,EAAclC,WAAW,CAAC,CAAD,CAAzB,CAAlB;AACD;AACF,KAPD,MAOO;AACLmC,MAAAA,eAAe,GAAG,CAACpD,KAAK,CAACV,GAAP,EAAY6D,WAAZ,CAAlB;AACD;;AAEDjC,IAAAA,cAAc,CAACkC,eAAD,CAAd;AACA1C,IAAAA,aAAa,CAAC0C,eAAD,CAAb;AACD,GAxBD;;AA0BA,MAAIE,kBAAkB,GAAG3E,MAAM,EAA/B;;AAEA,MAAI4E,WAAW,GAAG,SAASA,WAAT,CAAqBC,KAArB,EAA4B;AAC5C,WAAO,aAAa/E,KAAK,CAACgF,aAAN,CAAoBzE,KAApB,EAA2B;AAC7C0E,MAAAA,GAAG,EAAEF,KADwC;AAE7ChD,MAAAA,KAAK,EAAES,WAAW,CAACuC,KAAD,CAF2B;AAG7ClE,MAAAA,GAAG,EAAEA,GAHwC;AAI7CC,MAAAA,GAAG,EAAEA,GAJwC;AAK7CI,MAAAA,QAAQ,EAAEA,QALmC;AAM7C0B,MAAAA,QAAQ,EAAEA,QANmC;AAO7CsC,MAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB1B,QAAhB,EAA0B2B,KAA1B,EAAiCC,IAAjC,EAAuC;AAC7C,YAAID,KAAJ,EAAW;AACTpB,UAAAA,WAAW,CAACpB,OAAZ,IAAuB,CAAvB;AACAkC,UAAAA,kBAAkB,CAAClC,OAAnB,GAA6BH,WAA7B;AACD;;AAED,YAAId,GAAG,GAAG6B,kBAAkB,CAACC,QAAD,CAA5B;AACA,YAAI6B,eAAe,GAAGR,kBAAkB,CAAClC,OAAzC;AACA,YAAI,CAAC0C,eAAL,EAAsB;AACtB,YAAI3C,IAAI,GAAG,GAAG4C,MAAH,CAAUD,eAAV,CAAX;AACA3C,QAAAA,IAAI,CAACqC,KAAD,CAAJ,GAAcrD,GAAd;AACAe,QAAAA,cAAc,CAACC,IAAD,CAAd;;AAEA,YAAI0C,IAAJ,EAAU;AACRnD,UAAAA,aAAa,CAACS,IAAD,CAAb;AACA6C,UAAAA,MAAM,CAACC,UAAP,CAAkB,YAAY;AAC5BzB,YAAAA,WAAW,CAACpB,OAAZ,IAAuB,CAAvB;AACD,WAFD,EAEG,GAFH;AAGD;AACF;AA1B4C,KAA3B,CAApB;AA4BD,GA7BD;;AA+BA,SAAOxC,eAAe,CAACoB,KAAD,EAAQ,aAAavB,KAAK,CAACgF,aAAN,CAAoB,KAApB,EAA2B;AACpES,IAAAA,SAAS,EAAErF,UAAU,CAACO,WAAD,GAAeU,WAAW,GAAG,EAAd,EAAkBA,WAAW,CAACV,WAAW,GAAG,WAAf,CAAX,GAAyCO,QAA3D,EAAqEG,WAApF;AAD+C,GAA3B,EAExC,aAAarB,KAAK,CAACgF,aAAN,CAAoB,KAApB,EAA2B;AACzCS,IAAAA,SAAS,EAAE9E,WAAW,GAAG,kBADgB;AAEzC+E,IAAAA,OAAO,EAAE1B;AAFgC,GAA3B,EAGb,aAAahE,KAAK,CAACgF,aAAN,CAAoB,KAApB,EAA2B;AACzCS,IAAAA,SAAS,EAAE9E,WAAW,GAAG,QADgB;AAEzC+E,IAAAA,OAAO,EAAE1B,YAFgC;AAGzC2B,IAAAA,GAAG,EAAE/C;AAHoC,GAA3B,EAIb,aAAa5C,KAAK,CAACgF,aAAN,CAAoB,KAApB,EAA2B;AACzCS,IAAAA,SAAS,EAAE9E,WAAW,GAAG,OADgB;AAEzCiF,IAAAA,KAAK,EAAE;AACLC,MAAAA,KAAK,EAAEhD,QADF;AAELyB,MAAAA,IAAI,EAAExB;AAFD;AAFkC,GAA3B,CAJA,EAUZvB,KAAK,CAACP,KAAN,IAAe,aAAahB,KAAK,CAACgF,aAAN,CAAoB3E,KAApB,EAA2B;AACzD+C,IAAAA,MAAM,EAAEL,SADiD;AAEzDlC,IAAAA,GAAG,EAAEA,GAFoD;AAGzDC,IAAAA,GAAG,EAAEA,GAHoD;AAIzDgF,IAAAA,UAAU,EAAEtD,WAAW,CAAC,CAAD,CAJkC;AAKzDuD,IAAAA,UAAU,EAAEvD,WAAW,CAAC,CAAD;AALkC,GAA3B,CAVhB,EAgBZjB,KAAK,CAACN,KAAN,IAAe6D,WAAW,CAAC,CAAD,CAhBd,EAgBmBA,WAAW,CAAC,CAAD,CAhB9B,CAHA,CAF2B,EAqBUtD,KAAK,IAAI,aAAaxB,KAAK,CAACgF,aAAN,CAAoB1E,KAApB,EAA2B;AACpGO,IAAAA,GAAG,EAAEA,GAD+F;AAEpGC,IAAAA,GAAG,EAAEA,GAF+F;AAGpGU,IAAAA,KAAK,EAAEA,KAH6F;AAIpGsE,IAAAA,UAAU,EAAEtD,WAAW,CAAC,CAAD,CAJ6E;AAKpGuD,IAAAA,UAAU,EAAEvD,WAAW,CAAC,CAAD;AAL6E,GAA3B,CArBhC,CAArB,CAAtB;AA4BD,CA9KM","sourcesContent":["import React, { useMemo, useRef } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport classNames from 'classnames';\nimport Ticks from './ticks';\nimport Marks from './marks';\nimport Thumb from './thumb';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { nearest } from '../../utils/nearest';\nimport { usePropsValue } from '../../utils/use-props-value';\nvar classPrefix = \"adm-slider\";\nvar defaultProps = {\n  min: 0,\n  max: 100,\n  step: 1,\n  ticks: false,\n  range: false,\n  disabled: false\n};\nexport var Slider = function Slider(p) {\n  var _classNames;\n\n  var _a;\n\n  var props = mergeProps(defaultProps, p);\n  var min = props.min,\n      max = props.max,\n      disabled = props.disabled,\n      marks = props.marks,\n      ticks = props.ticks,\n      step = props.step;\n\n  function sortValue(val) {\n    return val.sort(function (a, b) {\n      return a - b;\n    });\n  }\n\n  function convertValue(value) {\n    return props.range ? value : [props.min, value];\n  }\n\n  function reverseValue(value) {\n    return props.range ? value : value[1];\n  }\n\n  function onAfterChange(value) {\n    var _a;\n\n    (_a = props.onAfterChange) === null || _a === void 0 ? void 0 : _a.call(props, reverseValue(value));\n  }\n\n  var _usePropsValue = usePropsValue({\n    value: props.value,\n    defaultValue: (_a = props.defaultValue) !== null && _a !== void 0 ? _a : props.range ? [min, min] : min,\n    onChange: props.onChange\n  }),\n      rawValue = _usePropsValue[0],\n      setRawValue = _usePropsValue[1];\n\n  var sliderValue = sortValue(convertValue(rawValue));\n\n  function setSliderValue(value) {\n    var next = sortValue(value);\n    var current = sliderValue;\n    if (next[0] === current[0] && next[1] === current[1]) return;\n    setRawValue(reverseValue(next));\n  }\n\n  var trackRef = useRef(null);\n  var fillSize = 100 * (sliderValue[1] - sliderValue[0]) / (max - min) + \"%\";\n  var fillStart = 100 * (sliderValue[0] - min) / (max - min) + \"%\"; // 计算要显示的点\n\n  var pointList = useMemo(function () {\n    if (marks) {\n      return Object.keys(marks).map(parseFloat).sort(function (a, b) {\n        return a - b;\n      });\n    } else {\n      var points = [];\n\n      for (var i = min; i <= max; i += step) {\n        points.push(i);\n      }\n\n      return points;\n    }\n  }, [marks, ticks, step, min, max]);\n\n  function getValueByPosition(position) {\n    var newPosition = position < min ? min : position > max ? max : position;\n    var value = min; // 显示了刻度点，就只能移动到点上\n\n    if (pointList.length) {\n      value = nearest(pointList, newPosition);\n    } else {\n      var lengthPerStep = 100 / ((max - min) / step);\n      var steps = Math.round(newPosition / lengthPerStep);\n      value = steps * lengthPerStep * (max - min) * 0.01 + min;\n    }\n\n    return value;\n  }\n\n  var dragLockRef = useRef(0);\n\n  var onTrackClick = function onTrackClick(event) {\n    if (dragLockRef.current > 0) return;\n    event.stopPropagation();\n    if (disabled) return;\n    var track = trackRef.current;\n    if (!track) return;\n    var sliderOffsetLeft = track.getBoundingClientRect().left;\n    var position = (event.clientX - sliderOffsetLeft) / Math.ceil(track.offsetWidth) * (max - min) + min;\n    var targetValue = getValueByPosition(position);\n    var nextSliderValue;\n\n    if (props.range) {\n      // 移动的滑块采用就近原则\n      if (Math.abs(targetValue - sliderValue[0]) > Math.abs(targetValue - sliderValue[1])) {\n        nextSliderValue = [sliderValue[0], targetValue];\n      } else {\n        nextSliderValue = [targetValue, sliderValue[1]];\n      }\n    } else {\n      nextSliderValue = [props.min, targetValue];\n    }\n\n    setSliderValue(nextSliderValue);\n    onAfterChange(nextSliderValue);\n  };\n\n  var valueBeforeDragRef = useRef();\n\n  var renderThumb = function renderThumb(index) {\n    return /*#__PURE__*/React.createElement(Thumb, {\n      key: index,\n      value: sliderValue[index],\n      min: min,\n      max: max,\n      disabled: disabled,\n      trackRef: trackRef,\n      onDrag: function onDrag(position, first, last) {\n        if (first) {\n          dragLockRef.current += 1;\n          valueBeforeDragRef.current = sliderValue;\n        }\n\n        var val = getValueByPosition(position);\n        var valueBeforeDrag = valueBeforeDragRef.current;\n        if (!valueBeforeDrag) return;\n        var next = [].concat(valueBeforeDrag);\n        next[index] = val;\n        setSliderValue(next);\n\n        if (last) {\n          onAfterChange(next);\n          window.setTimeout(function () {\n            dragLockRef.current -= 1;\n          }, 100);\n        }\n      }\n    });\n  };\n\n  return withNativeProps(props, /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(classPrefix, (_classNames = {}, _classNames[classPrefix + \"-disabled\"] = disabled, _classNames))\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classPrefix + \"-track-container\",\n    onClick: onTrackClick\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classPrefix + \"-track\",\n    onClick: onTrackClick,\n    ref: trackRef\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classPrefix + \"-fill\",\n    style: {\n      width: fillSize,\n      left: fillStart\n    }\n  }), props.ticks && /*#__PURE__*/React.createElement(Ticks, {\n    points: pointList,\n    min: min,\n    max: max,\n    lowerBound: sliderValue[0],\n    upperBound: sliderValue[1]\n  }), props.range && renderThumb(0), renderThumb(1))), marks && /*#__PURE__*/React.createElement(Marks, {\n    min: min,\n    max: max,\n    marks: marks,\n    lowerBound: sliderValue[0],\n    upperBound: sliderValue[1]\n  })));\n};"]},"metadata":{},"sourceType":"module"}