{"ast":null,"code":"import React, { forwardRef, useRef, useState, useEffect, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useThrottleFn } from 'ahooks';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { Sidebar } from './sidebar';\nimport { IndexBarContext } from './context';\nimport { convertPx } from '../../utils/convert-px';\nvar classPrefix = \"adm-index-bar\";\nvar defaultProps = {\n  sticky: true\n};\nexport var IndexBar = /*#__PURE__*/forwardRef(function (p, ref) {\n  var _classNames;\n\n  var props = mergeProps(defaultProps, p);\n  var titleHeight = convertPx(35);\n  var bodyRef = useRef(null);\n\n  var _useState = useState([]),\n      indexes = _useState[0],\n      setIndexes = _useState[1];\n\n  var _useState2 = useState(indexes[0]),\n      activeIndex = _useState2[0],\n      setActiveIndex = _useState2[1];\n\n  useImperativeHandle(ref, function () {\n    return {\n      scrollTo: scrollTo\n    };\n  });\n\n  function scrollTo(index) {\n    var body = bodyRef.current;\n    if (!body) return;\n    var children = body.children;\n\n    for (var i = 0; i < children.length; i++) {\n      var panel = children.item(i);\n      if (!panel) continue;\n      var panelIndex = panel.dataset['index'];\n\n      if (panelIndex === index) {\n        body.scrollTop = panel.offsetTop;\n        setActiveIndex(index);\n        return;\n      }\n    }\n  }\n\n  var _useThrottleFn = useThrottleFn(function () {\n    var body = bodyRef.current;\n    if (!body) return;\n    var scrollTop = body.scrollTop;\n    var children = body.getElementsByClassName(classPrefix + \"-anchor\");\n\n    for (var i = 0; i < children.length; i++) {\n      var panel = children.item(i);\n      if (!panel) continue;\n      var panelIndex = panel.dataset['index'];\n      if (!panelIndex) continue;\n\n      if (panel.offsetTop + panel.clientHeight - titleHeight > scrollTop) {\n        setActiveIndex(panelIndex);\n        return;\n      }\n    }\n  }, {\n    wait: 50,\n    trailing: true,\n    leading: true\n  }),\n      checkActiveIndex = _useThrottleFn.run;\n\n  useEffect(function () {\n    if (!indexes.length) return;\n    checkActiveIndex();\n  }, [indexes]);\n  var element = withNativeProps(props, /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(\"\" + classPrefix, (_classNames = {}, _classNames[classPrefix + \"-sticky\"] = props.sticky, _classNames))\n  }, /*#__PURE__*/React.createElement(Sidebar, {\n    indexes: indexes,\n    activeIndex: activeIndex,\n    onActive: function onActive(index) {\n      scrollTo(index);\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: classPrefix + \"-body\",\n    ref: bodyRef,\n    onScroll: checkActiveIndex\n  }, props.children)));\n  return /*#__PURE__*/React.createElement(IndexBarContext.Provider, {\n    value: {\n      indexes: indexes,\n      setIndexes: setIndexes\n    }\n  }, element);\n});","map":{"version":3,"sources":["/Users/brandonliu/Project/goairmart/antd-demo/node_modules/antd-mobile/es/components/index-bar/index-bar.js"],"names":["React","forwardRef","useRef","useState","useEffect","useImperativeHandle","classNames","withNativeProps","useThrottleFn","mergeProps","Sidebar","IndexBarContext","convertPx","classPrefix","defaultProps","sticky","IndexBar","p","ref","_classNames","props","titleHeight","bodyRef","_useState","indexes","setIndexes","_useState2","activeIndex","setActiveIndex","scrollTo","index","body","current","children","i","length","panel","item","panelIndex","dataset","scrollTop","offsetTop","_useThrottleFn","getElementsByClassName","clientHeight","wait","trailing","leading","checkActiveIndex","run","element","createElement","className","onActive","onScroll","Provider","value"],"mappings":"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","sourcesContent":["import React, { forwardRef, useRef, useState, useEffect, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useThrottleFn } from 'ahooks';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { Sidebar } from './sidebar';\nimport { IndexBarContext } from './context';\nimport { convertPx } from '../../utils/convert-px';\nvar classPrefix = \"adm-index-bar\";\nvar defaultProps = {\n  sticky: true\n};\nexport var IndexBar = /*#__PURE__*/forwardRef(function (p, ref) {\n  var _classNames;\n\n  var props = mergeProps(defaultProps, p);\n  var titleHeight = convertPx(35);\n  var bodyRef = useRef(null);\n\n  var _useState = useState([]),\n      indexes = _useState[0],\n      setIndexes = _useState[1];\n\n  var _useState2 = useState(indexes[0]),\n      activeIndex = _useState2[0],\n      setActiveIndex = _useState2[1];\n\n  useImperativeHandle(ref, function () {\n    return {\n      scrollTo: scrollTo\n    };\n  });\n\n  function scrollTo(index) {\n    var body = bodyRef.current;\n    if (!body) return;\n    var children = body.children;\n\n    for (var i = 0; i < children.length; i++) {\n      var panel = children.item(i);\n      if (!panel) continue;\n      var panelIndex = panel.dataset['index'];\n\n      if (panelIndex === index) {\n        body.scrollTop = panel.offsetTop;\n        setActiveIndex(index);\n        return;\n      }\n    }\n  }\n\n  var _useThrottleFn = useThrottleFn(function () {\n    var body = bodyRef.current;\n    if (!body) return;\n    var scrollTop = body.scrollTop;\n    var children = body.getElementsByClassName(classPrefix + \"-anchor\");\n\n    for (var i = 0; i < children.length; i++) {\n      var panel = children.item(i);\n      if (!panel) continue;\n      var panelIndex = panel.dataset['index'];\n      if (!panelIndex) continue;\n\n      if (panel.offsetTop + panel.clientHeight - titleHeight > scrollTop) {\n        setActiveIndex(panelIndex);\n        return;\n      }\n    }\n  }, {\n    wait: 50,\n    trailing: true,\n    leading: true\n  }),\n      checkActiveIndex = _useThrottleFn.run;\n\n  useEffect(function () {\n    if (!indexes.length) return;\n    checkActiveIndex();\n  }, [indexes]);\n  var element = withNativeProps(props, /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(\"\" + classPrefix, (_classNames = {}, _classNames[classPrefix + \"-sticky\"] = props.sticky, _classNames))\n  }, /*#__PURE__*/React.createElement(Sidebar, {\n    indexes: indexes,\n    activeIndex: activeIndex,\n    onActive: function onActive(index) {\n      scrollTo(index);\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: classPrefix + \"-body\",\n    ref: bodyRef,\n    onScroll: checkActiveIndex\n  }, props.children)));\n  return /*#__PURE__*/React.createElement(IndexBarContext.Provider, {\n    value: {\n      indexes: indexes,\n      setIndexes: setIndexes\n    }\n  }, element);\n});"]},"metadata":{},"sourceType":"module"}